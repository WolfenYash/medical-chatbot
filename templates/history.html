{% extends "layout.html" %}
{% block title %}Chat History{% endblock %}

{% block main %}
<div class="container mt-4">
    <h2>Your Chat History</h2>

    {% if history %}
        {% for row in history %}
            <div class="chat-entry mb-3">
                <button class="btn btn-outline-dark w-100 text-start toggle-question" type="button">
                    {{ row.user_message }}
                </button>

                <div class="chat-details p-3 border rounded mt-2" style="display: none;">
                    <p><strong>Bot:</strong> {{ row.bot_response }}</p>
                    <p><small><strong>Time:</strong> {{ row.timestamp }}</small></p>

                    <form method="POST">
                        <input type="hidden" name="row_id" value="{{ row.id }}">
                        <label for="feedback">Feedback:</label>
                        <select name="feedback" class="form-select" style="width: auto; display: inline-block;">
                            <option value="">-- Select --</option>
                            <option value="good" {% if row.feedback == 'good' %}selected{% endif %}>üëç Good</option>
                            <option value="bad" {% if row.feedback == 'bad' %}selected{% endif %}>üëé Bad</option>
                        </select>
                        <button type="submit" class="btn btn-sm btn-primary">Save</button>
                    </form>
                </div>
            </div>
        {% endfor %}
    {% else %}
        <p>No chat history available.</p>
    {% endif %}
</div>

{% endblock %}
